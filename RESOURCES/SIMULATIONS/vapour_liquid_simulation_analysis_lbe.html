
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Analysing Results &#8212; DL_Software Digital Guide (DL_SDG) 2.4 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/classic.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom_CY.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Structures" href="../STRUCTURES/Structures.html" />
    <link rel="prev" title="Visualising Simulation" href="vapour_liquid_simulation_visualise_lbe.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../STRUCTURES/Structures.html" title="Structures"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="vapour_liquid_simulation_visualise_lbe.html" title="Visualising Simulation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">DL_Software Digital Guide (DL_SDG) 2.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="Simulations.html" >Simulations</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="vapour_liquid_sim_lbe.html" accesskey="U">Simulating vapour-liquid coexistence using LBE (DL_MESO)</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Analysing Results</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="analysing-results">
<h1>Analysing Results<a class="headerlink" href="#analysing-results" title="Permalink to this headline">¶</a></h1>
<p>The main results from a DL_MESO_LBE simulation are snapshots taken at periodic intervals given in VTK files, and the total masses and momenta of the fluids at those same points in time given on the screen or in the standard output. As well as <a class="reference internal" href="vapour_liquid_simulation_visualise_lbe.html#vapour-liquid-simulation-visualise-lbe"><span class="std std-ref">visualising the simulation</span></a>, the snapshots can be used to analyse it further by calculating (and visualising) other properties.</p>
<p>ParaView can be used to visualise and calculate certain properties for each snapshot generated by a DL_MESO_LBE calculation. These include graphs that can be viewed in ParaView itself: the values used for these plots can be exported to text files to visualise later using graphing software such as Gnuplot or a spreadsheet program after importing the file. Alternatively, a Python script specific to the simulations given here is available to work out certain properties.</p>
<dl class="field-list simple">
<dt class="field-odd">TIP</dt>
<dd class="field-odd"><p>To display the available command-line options for an analysis script, run it with the option <code class="docutils literal notranslate"><span class="pre">-h</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">vtk_to_twophase.py</span> <span class="pre">-h</span></code>. Using this option will not run any analysis.</p>
</dd>
</dl>
<p>Other Python packages (<code class="docutils literal notranslate"><span class="pre">docopt</span></code>, <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, <code class="docutils literal notranslate"><span class="pre">scipy</span></code>, <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and <code class="docutils literal notranslate"><span class="pre">scikit-image</span></code>) may also need to be installed to run the analysis scripts. If any of these are missing as indicated in any error messages when trying to run a script, they can be installed using Python’s package installer, e.g. :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">docopt</span>
</pre></div>
</div>
<p>Some Python 3 installations may use <code class="docutils literal notranslate"><span class="pre">pip3</span></code> instead of <code class="docutils literal notranslate"><span class="pre">pip</span></code> for the installer and <code class="docutils literal notranslate"><span class="pre">python3</span></code> in place of <code class="docutils literal notranslate"><span class="pre">python</span></code> to run scripts or the interpreter.</p>
<p><strong>Equilibrium densities of vapour and liquid phases</strong>:</p>
<p>By the end of the DL_MESO_LBE calculations of our fluid (hydrogen chloride), it should have separated into two phases: one at a lower density that we can consider as vapour, and a higher density one that is liquid. You can check this has happened simply by opening the VTK files in ParaView and playing through the calculation.</p>
<figure class="align-default">
<img alt="../../_images/paraview.png" src="../../_images/paraview.png" />
</figure>
<p>The example above for the simulation with Shan-Chen pseudopotential interactions shows that the fluid has separated into a liquid drop surrounded by vapour. The colour scale indicates the minimum and maximum densities found on the grid, which are also available inside the Information tab. These indicate that the vapour density <span class="math notranslate nohighlight">\(\rho_v \approx 0.3669\)</span> and the liquid density <span class="math notranslate nohighlight">\(\rho_l \approx 6.5017\)</span>.</p>
<p>While not shown here, the equivalent densities from the free-energy calculation are <span class="math notranslate nohighlight">\(\rho_v \approx 0.4878\)</span> and <span class="math notranslate nohighlight">\(\rho_l \approx 6.2784\)</span>. Note that a Maxwell construction carried out by the <a class="reference download internal" download="" href="../../_downloads/42b8114bef26b2ab97c08866a1bc1669/maxwell.py"><code class="xref download docutils literal notranslate"><span class="pre">maxwell.py</span></code></a> script predicts <span class="math notranslate nohighlight">\(\rho_v \approx 0.3955\)</span> and <span class="math notranslate nohighlight">\(\rho_l \approx 6.4471\)</span>.</p>
<p><strong>Spurious microcurrents</strong>:</p>
<p>A consequence of how the fluid interactions are implemented in multiple-phase LBE simulations are spurious flows (<em>microcurrents</em>) generated at the interface between the phases. The magnitude of these microcurrents can affect the ability of a simulation to attain numerical stability and obtain an equilibrium state. This can be a particular problem for lower system temperatures and/or systems with flow fields: the microcurrents can limit the density contrast (ratio of liquid to vapour densities) that can be obtained.</p>
<p>To obtain a measure of the microcurrents for each simulation, you can visualise the velocity magnitudes in ParaView by using the pull-down boxes to select the property and, for vector properties such as velocity, magnitude (here giving the speed) and Cartesian coordinates.</p>
<figure class="align-default" id="id2">
<img alt="../../_images/shanchenmicrocurrent.png" src="../../_images/shanchenmicrocurrent.png" />
<figcaption>
<p><span class="caption-text">Plot of velocity magnitudes (speeds) for Shan-Chen calculation</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id3">
<img alt="../../_images/freeenergymicrocurrent.png" src="../../_images/freeenergymicrocurrent.png" />
<figcaption>
<p><span class="caption-text">Plot of velocity magnitudes (speeds) for free-energy calculation</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>The maximum fluid speed in the Shan-Chen simulation is around <span class="math notranslate nohighlight">\(0.0955 \frac{\Delta x}{\Delta t}\)</span>, while for the free-energy calculation it is around <span class="math notranslate nohighlight">\(0.0017 \frac{\Delta x}{\Delta t}\)</span>. Note that the maximum speeds can be found in regions corresponding to the interface between the two phases, where the densities have intermediate values between those for the bulk vapour and liquid.</p>
<dl class="field-list simple">
<dt class="field-odd">TIP</dt>
<dd class="field-odd"><p>It is possible to extend the range of density contrasts for both methods by reducing the magnitudes of microcurrents. One approach to do this is to reduce the values of <span class="math notranslate nohighlight">\(R\)</span> and <span class="math notranslate nohighlight">\(a\)</span> by a common factor <a class="reference internal" href="#liu2010" id="id1"><span>[Liu2010]</span></a>: this reduces the density or pseudopotential gradients (and thus Shan-Chen forces) but also widens the interfacial region. We can also use more complex collisions (e.g. multiple-relaxation-time, MRT) with additional parameters to reduce numerical instabilities in the LBE calculations.</p>
</dd>
</dl>
<p><strong>Drop size</strong>:</p>
<p>The Plot Over Line filter in ParaView can be used to look at the density profile through the liquid drop and the bulk vapour phase outside it. Note that the change in density from vapour to liquid (or vice versa) is not abrupt or stepwise, but involves a more gradual change over a short distance in the form of a hyperbolic tangent function.</p>
<figure class="align-default">
<img alt="../../_images/swiftdensityline.png" src="../../_images/swiftdensityline.png" />
</figure>
<dl class="field-list simple">
<dt class="field-odd">TIP</dt>
<dd class="field-odd"><p>To save the data used for the plot, select Save Data from the File menu and choose Comma or Tab Delimited Files as the file type, as well as a filename. The resulting file can then be opened in a spreadsheet program (e.g. Excel) or plotting software (e.g. Gnuplot), noting that the distance along the line is given as <code class="docutils literal notranslate"><span class="pre">arc_length</span></code>.</p>
</dd>
</dl>
<p>To determine the size (radius or diameter) of the drop, we can define a <em>phase index</em>:</p>
<div class="math notranslate nohighlight">
\[\rho^N = \frac{\rho - \rho_v}{\rho_l - \rho_v}\]</div>
<p>using the values of bulk vapour and liquid densities, <span class="math notranslate nohighlight">\(\rho_v\)</span> and <span class="math notranslate nohighlight">\(\rho_l\)</span>, as determined above. The value of this index will ordinarily vary between 0 for pure vapour and 1 for pure liquid, while the interfacial region will have intermediate values. The centre of mass for the drop can be determined by summing moments of the phase index, e.g.</p>
<div class="math notranslate nohighlight">
\[\mathbf{X} = \frac{\sum_{i} \rho^N (\mathbf{x}_i) \mathbf{x}_i}{\sum_{i} \rho^N (\mathbf{x}_i)}\]</div>
<dl class="field-list simple">
<dt class="field-odd">HINT</dt>
<dd class="field-odd"><p>Since the simulation box is periodic and the drop might cross a periodic boundary, we will use an alternative formula for the centre-of-mass that transforms Cartesian coordinates to polar ones and back again.</p>
</dd>
</dl>
<p>We can assume that the boundary between the two phases exists at <span class="math notranslate nohighlight">\(\rho^N = 0.5\)</span> and determine the size of the liquid drop based on this condition. This can be visualised by using the Calculator filter in ParaView to calculate the phase indices and using the Contour filter on the result to draw lines where its value equals 0.5.</p>
<figure class="align-default">
<img alt="../../_images/shanchenphaseindexcontour.png" src="../../_images/shanchenphaseindexcontour.png" />
</figure>
<p>The Python script <a class="reference download internal" download="" href="../../_downloads/e9dcf9903db578d8da7873b3715ac83d/vtk_to_twophase.py"><code class="xref download docutils literal notranslate"><span class="pre">vtk_to_twophase.py</span></code></a> can read the densities at all grid points in a VTK file, work out the minimum and maximum values as the vapour and liquid densities, and then calculate phase indices based on these values. It uses the phase indices to determine the centre of mass for the drop, which corresponds to the location of its centre, before finding a contour or isosurface as a series of interpolated points where <span class="math notranslate nohighlight">\(\rho^N = 0.5\)</span>. A function for an ellipse or ellipsoid is then fitted to those points to work out the semi-axes for the drop, and the geometric mean of these is given as the drop radius.</p>
<p>To run this script, type the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">vtk_to_twophase</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">vtkin</span> <span class="n">lbout000200</span><span class="o">.</span><span class="n">vts</span>
</pre></div>
</div>
<p>substituting <code class="docutils literal notranslate"><span class="pre">lbout000200.vts</span></code> with the name of the VTK file you wish to check, ideally one in which the system has equilibrated. If you wish to see the fit of the shape to the contour or isosurface, add <code class="docutils literal notranslate"><span class="pre">--plot</span></code> to the above command.</p>
<p>For the Shan-Chen calculation, the drop’s centre in the final snapshot is located at <span class="math notranslate nohighlight">\((36.95, 10.31)\)</span> and has a mean radius of <span class="math notranslate nohighlight">\(R = 14.31 \Delta x\)</span>. For the free-energy calculation, the drop centre is located at <span class="math notranslate nohighlight">\((22.79, 16.47)\)</span> and has a mean radius of <span class="math notranslate nohighlight">\(R = 14.52 \Delta x\)</span>.</p>
<p><strong>Interfacial width and surface tension</strong>:</p>
<p>To determine the interfacial width, threshold values of the phase index <span class="math notranslate nohighlight">\(\rho^N\)</span> need to be selected at which the transition between bulk phases and the interface can be identified. Since the bulk liquid and vapour phases are likely to vary slightly in density from the maximum and minimum values respectively, the phase index threshold values cannot be 0 and 1 but should be a little way inside of these, i.e. <span class="math notranslate nohighlight">\(\epsilon\)</span> and <span class="math notranslate nohighlight">\(1-\epsilon\)</span>. We recommend a value of <span class="math notranslate nohighlight">\(\epsilon = 0.1\)</span>.</p>
<p>The Python script <a class="reference download internal" download="" href="../../_downloads/e9dcf9903db578d8da7873b3715ac83d/vtk_to_twophase.py"><code class="xref download docutils literal notranslate"><span class="pre">vtk_to_twophase.py</span></code></a> can find the contours or isosurfaces where <span class="math notranslate nohighlight">\(\rho^N = \epsilon\)</span> and <span class="math notranslate nohighlight">\(\rho^N = 1-\epsilon\)</span>, fit ellipses or ellipsoids to those shapes and determine the difference in radii between them as the interfacial width. Type the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">vtk_to_twophase</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">vtkin</span> <span class="n">lbout000200</span><span class="o">.</span><span class="n">vts</span> <span class="o">--</span><span class="n">threshold</span> <span class="mf">0.1</span>
</pre></div>
</div>
<p>substituting <code class="docutils literal notranslate"><span class="pre">0.1</span></code> with the required value of <span class="math notranslate nohighlight">\(\epsilon\)</span>. If you wish to include the interface plot, the two additional contours will be displayed only if the system is two-dimensional, as shown below for the Shan-Chen calculation.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../../_images/dropfitboundary.png"><img alt="../../_images/dropfitboundary.png" src="../../_images/dropfitboundary.png" style="width: 10cm;" /></a>
</figure>
<p>For the Shan-Chen calculation, the interfacial thickness is estimated to be <span class="math notranslate nohighlight">\(4.53 \Delta x\)</span>, while for the free-energy calculation it is estimated to be <span class="math notranslate nohighlight">\(2.76 \Delta x\)</span>.</p>
<p>To determine the surface tension between the phases, we can exploit the Young-Laplace equation:</p>
<div class="math notranslate nohighlight">
\[\Delta p = - \frac{2 \gamma}{R}\]</div>
<p>where the reciprocal of the drop radius is equal to the mean curvature at the interface. To obtain the pressure difference across the interface <span class="math notranslate nohighlight">\(\Delta p\)</span>, we can use the vapour and liquid densities and the equation of state (including the parameters used for the calculation) to determine the pressures of both phases.</p>
<p>The same Python script can take the <strong>lbin.sys</strong> file used in the DL_MESO_LBE calculation as an additional input to specify the equation of state and its parameters, which can then be used to calculate the pressure difference and surface tension <span class="math notranslate nohighlight">\(\gamma\)</span>. Type the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">vtk_to_twophase</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">vtkin</span> <span class="n">lbout000200</span><span class="o">.</span><span class="n">vts</span> <span class="o">--</span><span class="n">lbin</span> <span class="n">lbin</span><span class="o">.</span><span class="n">sys</span>
</pre></div>
</div>
<p>substituting <code class="docutils literal notranslate"><span class="pre">lbin.sys</span></code> (if required) with the filename and location of the input file used for calculations.</p>
<p>For the Shan-Chen calculation, the surface tension is estimated to be <span class="math notranslate nohighlight">\(\gamma \approx 0.06348\)</span>, while for the free-energy calculation it is <span class="math notranslate nohighlight">\(\gamma \approx 0.040958\)</span>. The units for surface tension are equivalent to <span class="math notranslate nohighlight">\(\rho_0 \frac{\Delta x^3}{\Delta t^2}\)</span>, where <span class="math notranslate nohighlight">\(\rho_0\)</span> is the equivalent ‘real-life’ density for <span class="math notranslate nohighlight">\(\rho = 1\)</span> in the LBE calculations.</p>
<p>It should be noted that the surface tension and the interfacial width for the free-energy calculation can be controlled using the specified surface tension parameter <span class="math notranslate nohighlight">\(\kappa\)</span>, while these properties are generally not controllable for Shan-Chen calculations.</p>
<dl class="citation">
<dt class="label" id="liu2010"><span class="brackets"><a class="fn-backref" href="#id1">Liu2010</a></span></dt>
<dd><p>M Liu, Z Yu, T Wang, J Wang and LS Fan, A modified pseudopotential for a lattice Boltzmann simulation of bubbly flow, <em>Chemical Engineering Science</em>, <strong>65</strong>, 5615-5623, 2010, doi: 10.1016/j.ces.2010.08.014.</p>
</dd>
</dl>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../RST_PAGES/Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Resources.html">Resources</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Simulations.html">Simulations</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="parameter_examples.html">Example Simulation Models and Procedures</a></li>
<li class="toctree-l2"><a class="reference internal" href="liquid_sim.html">Simulating a liquid (DL_FIELD, DL_POLY, DL_ANALYSER)</a></li>
<li class="toctree-l2"><a class="reference internal" href="solution_sim.html">Simulating a solution (DL_FIELD, DL_POLY, DL_ANALYSER)</a></li>
<li class="toctree-l2"><a class="reference internal" href="liquid_sim_dpd.html">Simulating a liquid using DPD (DL_MESO)</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="vapour_liquid_sim_lbe.html">Simulating vapour-liquid coexistence using LBE (DL_MESO)</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="inputs_prep_lbe.html">Inputs Preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="vapour_liquid_simulation_run_lbe.html">Simulation Run</a></li>
<li class="toctree-l3"><a class="reference internal" href="vapour_liquid_simulation_visualise_lbe.html">Visualising Simulation</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Analysing Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../STRUCTURES/Structures.html">Structures</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../knowledge.html">Knowledge Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../RST_PAGES/Acknowledgements.html">Acknowledgements</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="vapour_liquid_simulation_visualise_lbe.html"
                        title="previous chapter">Visualising Simulation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../STRUCTURES/Structures.html"
                        title="next chapter">Structures</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../STRUCTURES/Structures.html" title="Structures"
             >next</a> |</li>
        <li class="right" >
          <a href="vapour_liquid_simulation_visualise_lbe.html" title="Visualising Simulation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">DL_Software Digital Guide (DL_SDG) 2.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="Simulations.html" >Simulations</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="vapour_liquid_sim_lbe.html" >Simulating vapour-liquid coexistence using LBE (DL_MESO)</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Analysing Results</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2025, DL_SDG.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.2.
    </div>
  </body>
</html>