
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Simulation Run &#8212; DL_Software Digital Guide (DL_SDG) 2.4 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/classic.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom_CY.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Visualising Simulation" href="vapour_liquid_simulation_visualise_lbe.html" />
    <link rel="prev" title="Inputs Preparation" href="inputs_prep_lbe.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="vapour_liquid_simulation_visualise_lbe.html" title="Visualising Simulation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="inputs_prep_lbe.html" title="Inputs Preparation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">DL_Software Digital Guide (DL_SDG) 2.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="Simulations.html" >Simulations</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="vapour_liquid_sim_lbe.html" accesskey="U">Simulating vapour-liquid coexistence using LBE (DL_MESO)</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Simulation Run</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="simulation-run">
<h1>Simulation Run<a class="headerlink" href="#simulation-run" title="Permalink to this headline">¶</a></h1>
<p><strong>Step 1</strong>: If you have not yet done so, <a class="reference internal" href="../dl_meso_howto.html#dl-meso-howto"><span class="std std-ref">obtain and compile DL_MESO</span></a>, specifically DL_MESO_LBE and the utilities. If you have an implementation of MPI on your machine, the parallel version of DL_MESO_LBE is highly recommended; otherwise compile the serial version with OpenMP.</p>
<dl class="field-list simple">
<dt class="field-odd">TIP</dt>
<dd class="field-odd"><p>If you are using a high-performance computing (HPC) facility, it <em>might</em> have a pre-compiled DL_MESO module that you can load in and use, which should make the required executable files available to you when submitting a job. If it does not, you can still compile DL_MESO_LBE yourself using the instructions linked above, although you may need to consult the HPC facility’s documentation to find out how to load in compilers and MPI.</p>
</dd>
</dl>
<p><strong>Step 2</strong>: Select your working folder, which can either be the <strong>dl_meso/WORK</strong> folder - where the DL_MESO and utility executables were created - or another folder of your choosing. If the latter, either copy the <strong>lbe.exe</strong> and other executable files (ending <strong>.exe</strong>) into that folder or work out the path to the <strong>dl_meso/WORK</strong> folder from that folder (e.g. use the command <code class="docutils literal notranslate"><span class="pre">pwd</span></code> to provide the absolute path).</p>
<p>Copy the <strong>lbin.sys</strong> and <strong>lbin.spa</strong> files into your working folder.</p>
<dl class="field-list simple">
<dt class="field-odd">TIP</dt>
<dd class="field-odd"><p>The DL_MESO_LBE executable (<strong>lbe.exe</strong>) expects the <strong>lbin.sys</strong> and <strong>lbin.spa</strong> input files to be in the same directory where it is launched, and needs to find these files to run a simulation successfully.</p>
</dd>
</dl>
<p><strong>Step 3</strong>: Navigate a terminal (command line) window into the working folder and either type</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">lbe</span><span class="o">.</span><span class="n">exe</span>
</pre></div>
</div>
<p>to run the serial version of DL_MESO_LBE in that folder, or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="n">X</span> <span class="o">./</span><span class="n">lbe</span><span class="o">.</span><span class="n">exe</span>
</pre></div>
</div>
<p>to run the parallel version, substituting <code class="docutils literal notranslate"><span class="pre">X</span></code> with the required number of processor cores. If the <strong>lbe.exe</strong> executable is in a different folder, replace the dot in either command with the path to the <strong>dl_meso/WORK</strong> folder, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">dl_meso</span><span class="o">/</span><span class="n">WORK</span><span class="o">/</span><span class="n">lbe</span><span class="o">.</span><span class="n">exe</span>
<span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="n">X</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">dl_meso</span><span class="o">/</span><span class="n">WORK</span><span class="o">/</span><span class="n">lbe</span><span class="o">.</span><span class="n">exe</span>
</pre></div>
</div>
<p>If you are using a high-performance computing (HPC) service with a batch job manager (e.g. Slurm), you will need to write a job script to specify the computing resources (number of cores, runtime) and the <code class="docutils literal notranslate"><span class="pre">mpirun</span></code> (or similar) command, which would be used to submit the calculation to a job queue. The form this job script should take and how to use it will depend on the HPC system in use, so you will need to consult its documentation for further details.</p>
<p>If you need to change the number of OpenMP threads being used for your calculation, either type the following command before running DL_MESO_LBE (substituting <code class="docutils literal notranslate"><span class="pre">X</span></code> with the required number of threads):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">OMP_NUM_THREADS</span><span class="o">=</span><span class="n">X</span>
</pre></div>
</div>
<p>or add a similar command to your job script (which may again depend on the HPC service in use), which normally sets the <em>number of threads used per processor core</em>.</p>
<p>DL_MESO_LBE will print messages about the simulation to either the screen or a file representing the standard output. It will also generate a number of files ending <strong>.vts</strong> (<strong>lbout000000.vts</strong> etc.) as simulation snapshots and an <strong>lbout.dump</strong> file to enable simulation restart.</p>
<dl class="field-list simple">
<dt class="field-odd">TIP</dt>
<dd class="field-odd"><p>If you want to redirect what is written to the screen or standard output to a file of your choosing (e.g. <strong>lboutput</strong>), you can add <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span> <span class="pre">lboutput</span></code> to the end of the command launching DL_MESO_LBE.</p>
</dd>
</dl>
<p>The images below show the contents of the screen/standard output for the vapour-liquid example using Shan-Chen interactions.</p>
<figure class="align-default">
<img alt="../../_images/output_vapour_liquid_lbe1.png" src="../../_images/output_vapour_liquid_lbe1.png" />
</figure>
<p>This first image shows a summary of the upcoming calculation, based on available numbers of cores and threads and the contents of the <strong>lbin.sys</strong> file, and the first few sample points. For each sampling timestep, the total mass of all fluids and the mass of each fluid (first line), the time taken to reach that point in seconds and the overall momentum of the system (second line).</p>
<figure class="align-default">
<img alt="../../_images/output_vapour_liquid_lbe2.png" src="../../_images/output_vapour_liquid_lbe2.png" />
</figure>
<p>The second image shows the end of the calculation, including the time taken to complete the calculation and a measure of calculation efficiency: Millions of Lattice Updates Per Second (MLUPS). A message is also included asking the user to cite DL_MESO if it is used for published research.</p>
<p><strong>Step 4</strong>: Take a look at the values of fluid masses and momentum, and check the calculation is numerically stable and/or settled to a steady state.</p>
<p>The overall mass for the majority of LBE calculations should remain constant throughout within available computational accuracy: very small changes to the overall mass or to the masses of individual fluids might happen over very large numbers of timesteps. Rapid changes of masses and/or values of ‘NaN’ (not a number) indicate that the calculation is numerically unstable and will need adjusting to alleviate this.</p>
<p>The vapour-liquid systems do not directly impose any motion to the system, so the overall momentum should be close to zero. For multiple-phase or multiple-fluid systems, there are likely to be spurious velocity fields generated at phase/fluid interfaces, but these should ideally be small and, for fully equilibrated systems with circular/spherical drops, symmetrical.</p>
<p><strong>Step 5</strong>: If the system has somehow not yet settled and/or an equilibrium state has not yet been reached, the simulation can be extended further to give it more time to equilibrate. This can be achieved in DL_MESO_LBE without re-calculating previous timesteps by <em>restarting</em> the simulation.</p>
<p>Open the <strong>lbin.sys</strong> file, increase the total number of timesteps (<code class="docutils literal notranslate"><span class="pre">total_steps</span></code>) and add the following line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">restart_simulation</span>           <span class="mi">1</span>
</pre></div>
</div>
<p>before running DL_MESO_LBE again (Step 3).</p>
<p>Restarting DL_MESO_LBE requires an <strong>lbout.dump</strong> file, which includes the values of all distribution functions for all grid points and is (over)written periodically by DL_MESO_LBE during a calculation.</p>
<p>To start a new calculation using the current state given in the <strong>lbout.dump</strong> file instead of a full restart, run the utility:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">dump_to_init</span><span class="o">.</span><span class="n">exe</span>
</pre></div>
</div>
<p>This creates an initial state file <strong>lbin.init</strong> from the <strong>lbout.dump</strong> file, which DL_MESO_LBE can use to work out the starting point for the new simulation.</p>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../RST_PAGES/Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Resources.html">Resources</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Simulations.html">Simulations</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="parameter_examples.html">Example Simulation Models and Procedures</a></li>
<li class="toctree-l2"><a class="reference internal" href="liquid_sim.html">Simulating a liquid (DL_FIELD, DL_POLY, DL_ANALYSER)</a></li>
<li class="toctree-l2"><a class="reference internal" href="solution_sim.html">Simulating a solution (DL_FIELD, DL_POLY, DL_ANALYSER)</a></li>
<li class="toctree-l2"><a class="reference internal" href="liquid_sim_dpd.html">Simulating a liquid using DPD (DL_MESO)</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="vapour_liquid_sim_lbe.html">Simulating vapour-liquid coexistence using LBE (DL_MESO)</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="inputs_prep_lbe.html">Inputs Preparation</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Simulation Run</a></li>
<li class="toctree-l3"><a class="reference internal" href="vapour_liquid_simulation_visualise_lbe.html">Visualising Simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="vapour_liquid_simulation_analysis_lbe.html">Analysing Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../STRUCTURES/Structures.html">Structures</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../knowledge.html">Knowledge Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../RST_PAGES/Acknowledgements.html">Acknowledgements</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="inputs_prep_lbe.html"
                        title="previous chapter">Inputs Preparation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="vapour_liquid_simulation_visualise_lbe.html"
                        title="next chapter">Visualising Simulation</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="vapour_liquid_simulation_visualise_lbe.html" title="Visualising Simulation"
             >next</a> |</li>
        <li class="right" >
          <a href="inputs_prep_lbe.html" title="Inputs Preparation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">DL_Software Digital Guide (DL_SDG) 2.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="Simulations.html" >Simulations</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="vapour_liquid_sim_lbe.html" >Simulating vapour-liquid coexistence using LBE (DL_MESO)</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Simulation Run</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2025, DL_SDG.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.2.
    </div>
  </body>
</html>