.. This file decsribes how to prepare a solution model

.. _Simulation run-label:
   
**************
Simulation Run
**************
(DL_POLY Run)

**Step 1: Renaming DL_FIELD files**

(i) Rename *dl_poly.CONFIG* to *CONFIG*

(ii) Rename *dl_poly.FIELD* to *FIELD*   

*dl_poly.CONTROL* generated by DL_FIELD is a generic form. Use your own version,  or use those as supplied for the exercise below.     

.. _step2-label:

**Step 2: Equilibration in NVE (DL_POLY)**

(i) Edit *CONTROL* making the necessary changes (see :download:`dl_poly.CONTROL1 </RESOURCES/SIMULATIONS/SOL_DOWNLOADS/dl_poly.CONTROL1>`). This *CONTROL* file instructs DL_POLY to run 200,000 MD steps at NVE ensemble, rescaling the temperature to exactly 300K at every MD step.
    
(ii) Using the variable timestep directive, enable DL_POLY to adjust the suitable timestep accordingly, especially at the early stage of simulation, to ensure the system dynamics are in control for high-energy conformation.
     
(iii) Run equilibration in DL_POLY. Repeat step 2 if necessary, by increasing the number of MD steps.

.. Warning::
   Remember to use the copy command to update *CONFIG* after each MD run, before carrying out the next run.


**Step 3: Equilibration in NPT (DL_POLY)**

Use  :download:`dl_poly.CONTROL2 </RESOURCES/SIMULATIONS/SOL_DOWNLOADS/dl_poly.CONTROL2>` for NPT equilibration, using the Hoover thermostat and barostat, and maintaining the temperature at 300K and pressure at 1 atm.
The directive restart 'noscale' is used to restart the simulation, starting at 0 timestep and extracting the initial velocity from  *CONFIG* obtained from :ref:`Step 2 <step2-label>`. If the directive is not used, the initial velocity will be randomly generated.

.. Warning::
   Do not just use the restart directive when the system ensemble is changed. You will get an error.


**Step 4: Sampling run (DL_POLY)**

Use :download:`dl_poly.CONTROL3 </RESOURCES/SIMULATIONS/SOL_DOWNLOADS/dl_poly.CONTROL3>` for the sampling run. *CONTROL* uses a fixed timestep directive of 0.0005 ps (0.5 fs), rather than a variable timestep. The timestep can be determined from the information shown at the heading of *CONFIG*::

 2   1   21397   200000   6.4000000E-04   1.2800000E+02

Where the 5th column shows the maximum timestep permitted when using the variable timestep directive. This means that the system will remain stable if we use any fixed timestep value of less than 6.4000000E-04 ps. Using a fixed timestep makes some analysis more tractable, although this is not essential in this exercise.




		     
